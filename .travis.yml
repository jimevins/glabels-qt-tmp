language: cpp

matrix:
  include:
  #####################
  #
  # Linux build
  #
  #####################
  - name: "Linux"
    os: linux
    dist: bionic
    sudo: require
    
    install:
      - sudo apt-get -y install qtbase5-dev libqt5svg5-dev qttools5-dev
      - sudo apt-get -y install zlib1g-dev
      - sudo apt-get -y install pkgconf libqrencode-dev
      - sudo apt-get -y install barcode

    script:
      - git fetch --unshallow # restore repository depth to properly count commits in auto versioning
      - git checkout master   # re-attach to master to satisfy auto versioning
      - mkdir build
      - cd build
      - cmake .. -DCMAKE_INSTALL_PREFIX=/usr

  #####################
  #
  # Windows build
  #
  #####################
  - name: "Windows"
    os: windows

    script:
      - git fetch --unshallow # restore repository depth to properly count commits in auto versioning
      - git checkout master   # re-attach to master to satisfy auto versioning
      - mkdir build
      - cd build
      #- cmake .. -G "Visual Studio 15 2017 Win64"

  #####################
  #
  # MacOS build
  #
  #####################
  - name: "MacOS"
    os: osx

    install:
      - brew install qt

    script:
      - git fetch --unshallow # restore repository depth to properly count commits in auto versioning
      - git checkout master   # re-attach to master to satisfy auto versioning
      - mkdir build
      - cd build
      - cmake .. -DCMAKE_PREFIX_PATH=/usr/local/opt/qt
